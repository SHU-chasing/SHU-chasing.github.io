<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chasing&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2020-10-28T11:32:47.617Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>祝健聪</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>web自动化实现SHU每日两报</title>
    <link href="http://example.com/2020/10/28/SHU%E6%AF%8F%E6%97%A5%E4%B8%A4%E6%8A%A5%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    <id>http://example.com/2020/10/28/SHU%E6%AF%8F%E6%97%A5%E4%B8%A4%E6%8A%A5%E8%87%AA%E5%8A%A8%E5%8C%96/</id>
    <published>2020-10-28T03:13:09.000Z</published>
    <updated>2020-10-28T11:32:47.617Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SHU每日两报脚本"><a href="#SHU每日两报脚本" class="headerlink" title="SHU每日两报脚本"></a>SHU每日两报脚本</h1><h2 id="1-实现原理"><a href="#1-实现原理" class="headerlink" title="1. 实现原理"></a>1. 实现原理</h2><p>利用python中的Selenium库，并结合浏览器驱动，来自动完成每日两报的操作，最后测试结果将每天的体温设置区间为36度至37度之间（含小数点后一位）。同时，在使用前可以自己选择相应的填报日期，也可以在特定日期之内完成相应的填报操作。</p><h2 id="2-使用教程"><a href="#2-使用教程" class="headerlink" title="2. 使用教程"></a>2. 使用教程</h2><h3 id="2-1-使用步骤"><a href="#2-1-使用步骤" class="headerlink" title="2.1. 使用步骤"></a>2.1. 使用步骤</h3><p>1、首先，此程序基于python 3.8.5版本运行，使用的浏览器为Edge，版本号86.0.622.51 (Official build) (64-bit)，IDE为PyCharm 2020.1.3 (Professional Edition)<br>2、打开命令行，使用pip指令安装selenium<br><code>pip install selenium</code><br>3、通过浏览器官网下载相应的浏览器启动插件，将其设置为系统环境变量(可选)，也可以在程序中自行设置浏览器启动驱动位置，如在E盘的E:\Edgedriver目录，就更改默认的地址 driverUrl = r”E:\Edgedriver\msedgedriver.exe”<br>4、运行程序时，请关闭其他任何可能影响浏览器运行的插件或者软件，如果网络信号不佳，则需要将time.sleep(1)中的数值调大，以等待网页的元素彻底加载成功</p><h2 id="3-代码实现"><a href="#3-代码实现" class="headerlink" title="3. 代码实现"></a>3. 代码实现</h2><h3 id="3-1-准备工作"><a href="#3-1-准备工作" class="headerlink" title="3.1. 准备工作"></a>3.1. 准备工作</h3><p>在本程序中，我们使用了三个库，分别是selenium（主角），time以及random。<br>其次，设置好自己的浏览器驱动位置以及每日一报链接位置，并填写好自己的账号密码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">myUsername=<span class="string">r&#x27;&#x27;</span> <span class="comment">#在此输入你的学号</span></span><br><span class="line">myPassword=<span class="string">r&#x27;&#x27;</span> <span class="comment">#在此输入你的姓名</span></span><br><span class="line">baseUrl=<span class="string">r&#x27;https://selfreport.shu.edu.cn/&#x27;</span> <span class="comment">#默认的每日两报地址</span></span><br><span class="line">driverUrl = <span class="string">r&quot;E:\Edgedriver\msedgedriver.exe&quot;</span> <span class="comment">#浏览器驱动，这里以Edge示例，不同的浏览器可以去官网下载</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="comment">#完成web自动化的一系列操作</span></span><br><span class="line"><span class="keyword">import</span> time <span class="comment">#设置程序等待时间，等待浏览器加载元素完全</span></span><br><span class="line"><span class="keyword">import</span> random <span class="comment">#设置温度随机数</span></span><br></pre></td></tr></table></figure><h3 id="3-2-登录账号"><a href="#3-2-登录账号" class="headerlink" title="3.2. 登录账号"></a>3.2. 登录账号</h3><p>准备好以上步骤以后，我们就可以打开浏览器并对其进行相应的操作。</p><p>输入代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Edge(driverUrl)<span class="comment">#通过驱动器打开浏览器</span></span><br><span class="line">driver.get(baseUrl)<span class="comment">#访问健康之路链接</span></span><br><span class="line">search_username = driver.find_element_by_id(<span class="string">&#x27;username&#x27;</span>)<span class="comment">#找到用户名位置</span></span><br><span class="line">search_username.send_keys(myUsername)<span class="comment">#填写用户名</span></span><br><span class="line">search_password = driver.find_element_by_id(<span class="string">&#x27;password&#x27;</span>)<span class="comment">#找到密码位置</span></span><br><span class="line">search_password.send_keys(myPassword)<span class="comment">#填写密码</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;submit&#x27;</span>).click()<span class="comment">#找到元素并且自动点击登录</span></span><br></pre></td></tr></table></figure><p>程序执行时，就会将自己的账号密码自动填入，效果图如下所示<br><img src="D:\Desktop\QQ截图20201028184049.png" alt="QQ截图20201028184049"></p><h3 id="3-3-进入报送历史界面"><a href="#3-3-进入报送历史界面" class="headerlink" title="3.3. 进入报送历史界面"></a>3.3. 进入报送历史界面</h3><p>首先输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_id(<span class="string">&#x27;lbReportHistory&#x27;</span>).click()<span class="comment">#找到对应历史报送的按钮，点击</span></span><br></pre></td></tr></table></figure><p>然后即可进入历史界面，在这里每天的报送记录罗列如下：</p><p><img src="https://raw.githubusercontent.com/SHU-chasing/imgs/main/%E6%AF%8F%E6%97%A5%E4%B8%A4%E6%8A%A5/%E5%A1%AB%E6%8A%A5.png?token=AQKMZEW4QNK6HDDX5QSUTBK7TFLDM" alt="填报"></p><h3 id="3-4-填写对应的信息"><a href="#3-4-填写对应的信息" class="headerlink" title="3.4. 填写对应的信息"></a>3.4. 填写对应的信息</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 点击对应的天数：</span></span><br><span class="line"><span class="built_in">object</span> = <span class="built_in">str</span>(date) + item</span><br><span class="line">driver.find_element_by_partial_link_text(<span class="built_in">object</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 勾选承诺项：</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;p1_ChengNuo-inputEl-icon&quot;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 填写体温，随机在36.0-37.0之间</span></span><br><span class="line">search_temperature = driver.find_element_by_id(<span class="string">&quot;p1_TiWen-inputEl&quot;</span>)</span><br><span class="line">temperature = <span class="built_in">str</span>(random.randint(<span class="number">360</span>, <span class="number">370</span>) / <span class="number">10</span>)</span><br><span class="line">search_temperature.send_keys(temperature)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 勾选状态&quot;良好&quot;</span></span><br><span class="line">element = driver.find_element_by_id(<span class="string">&quot;fineui_0-inputEl&quot;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当天随申码颜色：&quot;绿色&quot;</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;fineui_7-inputEl-icon&quot;</span>).click()</span><br><span class="line">element = driver.find_element_by_id(<span class="string">&#x27;fineui_7-inputEl-icon&#x27;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line"><span class="comment"># webdriver.ActionChains(driver).move_to_element(element).click(element).perform()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 明天是否到食堂就餐：&quot;早餐，中餐，晚餐&quot;</span></span><br><span class="line">element = driver.find_element_by_id(<span class="string">&#x27;fineui_8-inputEl-icon&#x27;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">element = driver.find_element_by_id(<span class="string">&#x27;fineui_9-inputEl-icon&#x27;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">element = driver.find_element_by_id(<span class="string">&#x27;fineui_10-inputEl-icon&#x27;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/SHU-chasing/imgs/main/%E6%AF%8F%E6%97%A5%E4%B8%A4%E6%8A%A5/%E5%A1%AB%E6%8A%A5%E7%9A%84%E6%97%A5%E6%9C%9F.png?token=AQKMZETZR64Z5GUHSUAVWJC7TFLIK" alt="填报的日期"></p><p>以上代码均是对于填写页面元素的捕捉，并对发现的第一个元素发起提交按钮。<br>在这里，程序代码不能写成如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以下操作无法实现，原因应该是元素定位相互覆盖。</span></span><br><span class="line"><span class="comment"># driver.find_element_by_id(&quot;fineui_8-inputEl-icon&quot;).click()</span></span><br><span class="line"><span class="comment"># driver.find_element_by_id(&quot;fineui_9-inputEl-icon&quot;).click()</span></span><br><span class="line"><span class="comment"># driver.find_element_bu_id(&quot;fineui_10-inputEl-icon&quot;).click()</span></span><br><span class="line"><span class="comment"># driver.find_element_by_id(&quot;p1_ctl00_btnSubmit&quot;).click()</span></span><br></pre></td></tr></table></figure><p>原因是代码中的元素相互覆盖，无法实现操作<br>最终选择并点击时的效果如下：<br><img src="https://raw.githubusercontent.com/SHU-chasing/imgs/main/%E6%AF%8F%E6%97%A5%E4%B8%A4%E6%8A%A5/%E9%80%89%E6%8B%A9.png?token=AQKMZEWJV3ZT4X6SL6OR4Q27TFLQ6" alt="选择"></p><h3 id="3-5-点击确认按钮"><a href="#3-5-点击确认按钮" class="headerlink" title="3.5. 点击确认按钮"></a>3.5. 点击确认按钮</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 点击提交</span></span><br><span class="line">element = driver.find_element_by_id(<span class="string">&quot;p1_ctl00_btnSubmit&quot;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 点击确认</span></span><br><span class="line">element = driver.find_element_by_id(<span class="string">&quot;fineui_14&quot;</span>)</span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">element = driver.find_element_by_id(<span class="string">&quot;fineui_19&quot;</span>)</span><br><span class="line"><span class="comment"># element = driver.find_element_by_class_name(&quot;f-btn-text&quot;)</span></span><br><span class="line">driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>在这里我使用了time.sleep()函数，为了让程序停顿，原页面加载的过程中，会出现提交框晚出现的情况，所以需要让程序“等待”浏览器加载结束，最后填报</p><h2 id="4-完整代码"><a href="#4-完整代码" class="headerlink" title="4. 完整代码"></a>4. 完整代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding = utf-8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2020-10-25 15:24</span></span><br><span class="line"><span class="comment">#@Author : Jiancong Zhu</span></span><br><span class="line"><span class="comment">#@Email : 643601464@qq.com</span></span><br><span class="line"><span class="comment">#@File : release.py</span></span><br><span class="line"><span class="comment">#@Software: PyCharm</span></span><br><span class="line"></span><br><span class="line">myUsername=<span class="string">r&#x27;&#x27;</span> <span class="comment">#在此输入你的学号</span></span><br><span class="line">myPassword=<span class="string">r&#x27;&#x27;</span> <span class="comment">#在此输入你的姓名</span></span><br><span class="line">baseUrl=<span class="string">r&#x27;https://selfreport.shu.edu.cn/&#x27;</span> <span class="comment">#默认的每日两报地址</span></span><br><span class="line">driverUrl = <span class="string">r&quot;E:\Edgedriver\msedgedriver.exe&quot;</span> <span class="comment">#浏览器驱动，这里以Edge示例，不同的浏览器可以去个官网下载</span></span><br><span class="line"><span class="keyword">from</span> selenium</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    print(<span class="string">&quot;Hello,&quot;</span>)</span><br><span class="line">    driver = webdriver.Edge(driverUrl)</span><br><span class="line">    driver.get(baseUrl)</span><br><span class="line">    search_username = driver.find_element_by_id(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    search_username.send_keys(myUsername)</span><br><span class="line">    search_password = driver.find_element_by_id(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    search_password.send_keys(myPassword)</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;submit&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> date <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>,<span class="number">26</span>,<span class="number">1</span>):<span class="comment">#在此修改你想实现的日期，左闭右开，如这里为[19,26)，即19至25号</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> [<span class="string">&#x27;晨报&#x27;</span>,<span class="string">&#x27;晚报&#x27;</span>]:</span><br><span class="line">            <span class="comment"># print(&quot;Hello, world!&quot;)</span></span><br><span class="line">            <span class="comment"># driver = webdriver.Edge(driverUrl)</span></span><br><span class="line">            <span class="comment"># driver.get(baseUrl)</span></span><br><span class="line">            <span class="comment"># driver.find_element_by_id(&#x27;username&#x27;)</span></span><br><span class="line">            <span class="comment"># search_username = driver.find_element_by_id(&#x27;username&#x27;)</span></span><br><span class="line">            <span class="comment"># search_username.send_keys(myUsername)</span></span><br><span class="line">            <span class="comment"># search_password = driver.find_element_by_id(&#x27;password&#x27;)</span></span><br><span class="line">            <span class="comment"># search_password.send_keys(myPassword)</span></span><br><span class="line">            <span class="comment"># driver.find_element_by_id(&#x27;submit&#x27;).click()</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进入报送历史：</span></span><br><span class="line">            driver.find_element_by_id(<span class="string">&#x27;lbReportHistory&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 点击对应的天数：</span></span><br><span class="line">            <span class="built_in">object</span> = <span class="built_in">str</span>(date) + item</span><br><span class="line">            driver.find_element_by_partial_link_text(<span class="built_in">object</span>).click()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 勾选承诺项：</span></span><br><span class="line">            driver.find_element_by_id(<span class="string">&quot;p1_ChengNuo-inputEl-icon&quot;</span>).click()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 填写体温，随机在36.0-37.0之间</span></span><br><span class="line">            search_temperature = driver.find_element_by_id(<span class="string">&quot;p1_TiWen-inputEl&quot;</span>)</span><br><span class="line">            temperature = <span class="built_in">str</span>(random.randint(<span class="number">360</span>, <span class="number">370</span>) / <span class="number">10</span>)</span><br><span class="line">            search_temperature.send_keys(temperature)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 勾选状态&quot;良好&quot;</span></span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&quot;fineui_0-inputEl&quot;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 当天随申码颜色：&quot;绿色&quot;</span></span><br><span class="line">            driver.find_element_by_id(<span class="string">&quot;fineui_7-inputEl-icon&quot;</span>).click()</span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&#x27;fineui_7-inputEl-icon&#x27;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            <span class="comment"># webdriver.ActionChains(driver).move_to_element(element).click(element).perform()</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 明天是否到食堂就餐：&quot;早餐，中餐，晚餐&quot;</span></span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&#x27;fineui_8-inputEl-icon&#x27;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&#x27;fineui_9-inputEl-icon&#x27;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&#x27;fineui_10-inputEl-icon&#x27;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 以下操作无法实现，原因应该是元素定位相互覆盖。</span></span><br><span class="line">            <span class="comment"># driver.find_element_by_id(&quot;fineui_8-inputEl-icon&quot;).click()</span></span><br><span class="line">            <span class="comment"># driver.find_element_by_id(&quot;fineui_9-inputEl-icon&quot;).click()</span></span><br><span class="line">            <span class="comment"># driver.find_element_bu_id(&quot;fineui_10-inputEl-icon&quot;).click()</span></span><br><span class="line">            <span class="comment"># driver.find_element_by_id(&quot;p1_ctl00_btnSubmit&quot;).click()</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 点击提交</span></span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&quot;p1_ctl00_btnSubmit&quot;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># 点击确认</span></span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&quot;fineui_14&quot;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            time.sleep(<span class="number">3</span>)</span><br><span class="line">            element = driver.find_element_by_id(<span class="string">&quot;fineui_19&quot;</span>)</span><br><span class="line">            <span class="comment"># element = driver.find_element_by_class_name(&quot;f-btn-text&quot;)</span></span><br><span class="line">            driver.execute_script(<span class="string">&quot;arguments[0].click();&quot;</span>, element)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    driver.quit()</span><br><span class="line">    print(<span class="string">&quot;world!&quot;</span>) <span class="comment"># 输出Hello,world! 完美的结束</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>: <span class="comment">#当程序执行时</span></span><br><span class="line">    main() <span class="comment">#开始</span></span><br></pre></td></tr></table></figure><h2 id="5-写在最后"><a href="#5-写在最后" class="headerlink" title="5. 写在最后"></a>5. 写在最后</h2><p>该项目从入门学习到实现用时一天，期间在调试的过程中，因为提交框的加载忘记设置延时，但是debug过程中，因为单步调试给了浏览器足够的加载时间，以至于此bug查了很久，在此感谢各网站的博主给出的经验。本着测试web自动化的初衷，加之校园的日填写网页结构较为简单，无复杂的html结构或者css样式，是个十分适合练习web自动化的网站。当然，为了实现最终结果也是走了不少弯路，这里感谢网站<code>http://www.testclass.net/</code>的免费教程，为此工程完成提供了不少帮助。此项目在GitHub完全开源，仅供学习使用，请不要为了省却时间，选择欺报或者瞒报，而放松了对疫情的警惕。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SHU每日两报脚本&quot;&gt;&lt;a href=&quot;#SHU每日两报脚本&quot; class=&quot;headerlink&quot; title=&quot;SHU每日两报脚本&quot;&gt;&lt;/a&gt;SHU每日两报脚本&lt;/h1&gt;&lt;h2 id=&quot;1-实现原理&quot;&gt;&lt;a href=&quot;#1-实现原理&quot; class=&quot;head</summary>
      
    
    
    
    <category term="脚本" scheme="http://example.com/categories/%E8%84%9A%E6%9C%AC/"/>
    
    <category term="web自动化" scheme="http://example.com/categories/%E8%84%9A%E6%9C%AC/web%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    <category term="python" scheme="http://example.com/categories/%E8%84%9A%E6%9C%AC/web%E8%87%AA%E5%8A%A8%E5%8C%96/python/"/>
    
    
    <category term="Selenium" scheme="http://example.com/tags/Selenium/"/>
    
    <category term="web自动化" scheme="http://example.com/tags/web%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>WEB自动化笔记</title>
    <link href="http://example.com/2020/10/28/WEB%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2020/10/28/WEB%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-28T03:13:09.000Z</published>
    <updated>2020-10-28T03:35:22.011Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Selenium3实现网页自动化"><a href="#Selenium3实现网页自动化" class="headerlink" title="Selenium3实现网页自动化"></a>Selenium3实现网页自动化</h1><h2 id="1-初步工作"><a href="#1-初步工作" class="headerlink" title="1.初步工作"></a>1.初步工作</h2><h3 id="1-1-环境配置"><a href="#1-1-环境配置" class="headerlink" title="1.1 环境配置"></a>1.1 环境配置</h3><p>安装Selenium</p><p>本文使用的是python3.8.4 64bit</p><p>使用pip指令安装selenium</p><p><code>pip install selenium</code></p><h3 id="1-2-设置浏览器驱动"><a href="#1-2-设置浏览器驱动" class="headerlink" title="1.2 设置浏览器驱动"></a>1.2 设置浏览器驱动</h3><p>首先设置浏览器的地址，手动创建一个存放浏览器驱动的目录，如： E:\driver , 将下载的浏览器驱动文件（例如：chromedriver、geckodriver）丢到该目录下。</p><p>我的电脑–&gt;属性–&gt;系统设置–&gt;高级–&gt;环境变量–&gt;系统变量–&gt;Path，将“E:\driver”目录添加到Path的值中。</p><p>验证不同的浏览器驱动是否正常使用。</p><p>from selenium import webdriver</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Firefox()   <span class="comment"># Firefox浏览器</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()    <span class="comment"># Chrome浏览器</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Ie()        <span class="comment"># Internet Explorer浏览器</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge()      <span class="comment"># Edge浏览器</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Opera()     <span class="comment"># Opera浏览器</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.PhantomJS()   <span class="comment"># PhantomJS</span></span><br></pre></td></tr></table></figure><h2 id="2-基本操作"><a href="#2-基本操作" class="headerlink" title="2.基本操作"></a>2.基本操作</h2><h3 id="2-1-元素定位"><a href="#2-1-元素定位" class="headerlink" title="2.1 元素定位"></a>2.1 元素定位</h3><p>Selenium提供了8种定位方式。</p><blockquote><p>id<br>name<br>class name<br>name<br>link text<br>partial link text<br>xpath<br>css selector</p></blockquote><p>这8种定位方式在Python selenium中所对应的方法为：</p><blockquote><p>find_element_by_id()<br>find_element_by_name()<br>find_element_by_class_name()<br>find_element_by_tag_name()<br>find_element_by_link_text()<br>find_element_by_partial_link_text()<br>find_element_by_xpath()<br>find_element_by_css_selector()</p></blockquote><p>定位使用的方法</p><p>假如我们有一个Web页面，通过前端工具（如，Firebug）查看到一个元素的属性是这样的。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">link</span>=<span class="string">&quot;#0000cc&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;result_logo&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">onmousedown</span>=<span class="string">&quot;return c(&#123;&#x27;fm&#x27;:&#x27;tab&#x27;,&#x27;tab&#x27;:&#x27;logo&#x27;&#125;)&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;form&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fm&quot;</span> <span class="attr">name</span>=<span class="string">&quot;f&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/s&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;soutu-btn&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;kw&quot;</span> <span class="attr">class</span>=<span class="string">&quot;s_ipt&quot;</span> <span class="attr">name</span>=<span class="string">&quot;wd&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;255&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span>&gt;</span>输入框</span><br></pre></td></tr></table></figure><p>我们的目的是要定位input标签的输入框。</p><ul><li>通过id定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_id(<span class="string">&quot;kw&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>通过name定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_name(<span class="string">&quot;wd&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>通过class name定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_class_name(<span class="string">&quot;s_ipt&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>通过tag name定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_tag_name(<span class="string">&quot;input&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>1、 通过xpath定位，xpath定位有多种写法，这里列几个常用写法: **<br>    Xpath支持ID、Class、Name定位功能，以以下三者为例：<br>　1）、通过ID定位<br>　　　　//<em>[@id=’kw’]<br>　2）、通过Class定位<br>　　　　//</em>[@class=’class_name’]<br>　3）、 通过Name定位<br>　　　　//<em>[@name=’name’]<br><strong>2、如果标签没有ID、Class、Name三总属性，Xpath还支持属性定位功能</strong><br>　　　　@ 代表以属性定位，后面可以接标签中任意属性<br>　　　　//</em>[@other=’attribute’]<br>**3、当标签的属性重复时，Xpath提供了通过标签来进行过滤</strong><br>　　　　将 * 换位任意标签名，则可根据标签进行筛选<br>　　　　//input[@placeholder=’用户名’]<br><strong>4、当标签页重复时，Xpath提供了层级过滤</strong><br>    例如：找不到儿子，那么就先找他的爸爸，实在不行可以再找他的爷爷<br>    1）、支持通过 / 进行层级递进，找到符合层级关系的标签<br>　　　    //form/div/input[@placeholder=”用户名”]<br>    2）、当层级都重复时，可以通过单个层级的属性进行定位<br> 　      　//form/div[@class=’login-user’]/input<br><strong>5、一个元素它的兄弟元素跟它的标签一样，这时候无法通过层级定位到。因为都是一个父亲生的，多胞胎兄弟。Xpath提供了索引过滤</strong><br>　　　　通过索引，在List中定位属性，与python的索引有些差别，Xpath从1开始<br>　　　　//select[@name=’city’][1]/option[1]<br><strong>6、上面几种如果都用上了之后还重复的话，我们就可以使用Xpath提供的终极神器，逻辑运算定位。and 或 or</strong>　　　<br>　1）、通过and来缩小过滤的范围，只有条件都符合时才能定位到<br> 　　　　　//select[@name=’city’ and @size=’4’ and @multiple=”multiple”]<br>　2）、or就相反了，只要这些筛选中，其中一个出现那么久匹配到了<br>　　　　　　//select[@name=’city’ or @size=’4’]</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//*[@id=&#x27;kw&#x27;]&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//*[@name=&#x27;wd&#x27;]&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//input[@class=&#x27;s_ipt&#x27;]&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;/html/body/form/span/input&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//span[@class=&#x27;soutu-btn&#x27;]/input&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//form[@id=&#x27;form&#x27;]/span/input&quot;</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">&quot;//input[@id=&#x27;kw&#x27; and @name=&#x27;wd&#x27;]&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>通过css定位，css定位有多种写法，这里列几个常用写法:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;[name=wd]&quot;</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;.s_ipt&quot;</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;html &gt; body &gt; form &gt; span &gt; input&quot;</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;span.soutu-btn&gt; input#kw&quot;</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">&quot;form#form &gt; span &gt; input&quot;</span>)</span><br></pre></td></tr></table></figure><p>接下来，我们的页面上有一组文本链接。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;mnav&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://news.baidu.com&quot;</span> <span class="attr">name</span>=<span class="string">&quot;tj_trnews&quot;</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;mnav&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://www.hao123.com&quot;</span> <span class="attr">name</span>=<span class="string">&quot;tj_trhao123&quot;</span>&gt;</span>hao123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>通过link text定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_link_text(<span class="string">&quot;新闻&quot;</span>)</span><br><span class="line">dr.find_element_by_link_text(<span class="string">&quot;hao123&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>通过link text定位:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dr.find_element_by_partial_link_text(<span class="string">&quot;新&quot;</span>)</span><br><span class="line">dr.find_element_by_partial_link_text(<span class="string">&quot;hao&quot;</span>)</span><br><span class="line">dr.find_element_by_partial_link_text(<span class="string">&quot;123&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="2-2-浏览器控制"><a href="#2-2-浏览器控制" class="headerlink" title="2.2 浏览器控制"></a>2.2 浏览器控制</h3><ol><li>控制浏览器大小</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.set_window_size(<span class="number">480</span>, <span class="number">800</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>前进，后退</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.forward()</span><br><span class="line">driver.back()</span><br></pre></td></tr></table></figure><ol start="3"><li>刷新页面</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.refresh()</span><br></pre></td></tr></table></figure><h3 id="2-3-模拟点击和输入"><a href="#2-3-模拟点击和输入" class="headerlink" title="2.3 模拟点击和输入"></a>2.3 模拟点击和输入</h3><p>点击和输入<br>前面我们已经学习了定位元素， 定位只是第一步， 定位之后需要对这个元素进行操作， 或单击（按钮） 或输入（输入框） ， 下面就来认识 WebDriver 中最常用的几个方法：</p><p>clear()： 清除文本。</p><p>send_keys (value)： 模拟按键输入。</p><p>click()：    单击元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).clear()</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;selenium&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>提交<br>submit()，<br>submit()方法用于提交表单。 例如， 在搜索框输入关键字之后的“回车” 操作， 就可以通过该方法模拟。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">search_text = driver.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>)</span><br><span class="line">search_text.send_keys(<span class="string">&#x27;selenium&#x27;</span>)</span><br><span class="line">search_text.submit()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>有时候 submit()可以与 click()方法互换来使用， submit()同样可以提交一个按钮， 但 submit()的应用范围远不及 click()广泛。</p><p>其他常用方法<br>size： 返回元素的尺寸。</p><p>text： 获取元素的文本。</p><p>get_attribute(name)： 获得属性值。</p><p>is_displayed()： 设置该元素是否用户可见。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得输入框的尺寸</span></span><br><span class="line">size = driver.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>).size</span><br><span class="line">print(size)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回百度页面底部备案信息</span></span><br><span class="line">text = driver.find_element_by_id(<span class="string">&quot;cp&quot;</span>).text</span><br><span class="line">print(text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回元素的属性值， 可以是 id、 name、 type 或其他任意属性</span></span><br><span class="line">attribute = driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).get_attribute(<span class="string">&#x27;type&#x27;</span>)</span><br><span class="line">print(attribute)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回元素的结果是否可见， 返回结果为 True 或 False</span></span><br><span class="line">result = driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).is_displayed()</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>输出结果：</p><p>{‘width’: 500, ‘height’: 22}<br>©2015 Baidu 使用百度前必读 意见反馈 京 ICP 证 030173 号<br>text<br>True<br>执行上面的程序并查看结果： size 方法用于获取百度输入框的宽、 高， text 方法用于获得百度底部的备案信息， get_attribute()用于获得百度输入的 type 属性的值， is_displayed()用于返回一个元素是否可见， 如果可见则返回 True， 否则返回 False。</p><h3 id="2-4-鼠标操作"><a href="#2-4-鼠标操作" class="headerlink" title="2.4 鼠标操作"></a>2.4 鼠标操作</h3><p>在 WebDriver 中， 将这些关于鼠标操作的方法封装在 ActionChains 类提供。</p><p>ActionChains 类提供了鼠标操作的常用方法：</p><p>perform()： 执行所有 ActionChains 中存储的行为；</p><p>context_click()： 右击；</p><p>double_click()： 双击；</p><p>drag_and_drop()： 拖动；</p><p>move_to_element()： 鼠标悬停。</p><p>鼠标悬停操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="comment"># 引入 ActionChains 类</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.cn&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定位到要悬停的元素</span></span><br><span class="line">above = driver.find_element_by_link_text(<span class="string">&quot;设置&quot;</span>)</span><br><span class="line"><span class="comment"># 对定位到的元素执行鼠标悬停操作</span></span><br><span class="line">ActionChains(driver).move_to_element(above).perform()</span><br></pre></td></tr></table></figure><p>……</p><p>from selenium.webdriver import ActionChains<br>导入提供鼠标操作的 ActionChains 类。</p><p>ActionChains(driver)<br>调用 ActionChains()类， 将浏览器驱动 driver 作为参数传入。</p><p>move_to_element(above)<br>context_click()方法用于模拟鼠标右键操作， 在调用时需要指定元素定位。</p><p>perform()<br>执行所有 ActionChains 中存储的行为， 可以理解成是对整个操作的提交动作。</p><h3 id="2-5-键盘操作"><a href="#2-5-键盘操作" class="headerlink" title="2.5 键盘操作"></a>2.5 键盘操作</h3><p>Keys()类提供了键盘上几乎所有按键的方法。 前面了解到， send_keys()方法可以用来模拟键盘输入， 除此 之外， 我们还可以用它来输入键盘上的按键， 甚至是组合键， 如 Ctrl+A、 Ctrl+C 等。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="comment"># 引入 Keys 模块</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入框输入内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;seleniumm&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除多输入的一个 m</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.BACK_SPACE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入空格键+“教程”</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.SPACE)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;教程&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctrl+a 全选输入框内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.CONTROL, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctrl+x 剪切输入框内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.CONTROL, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctrl+v 粘贴内容到输入框</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(Keys.CONTROL, <span class="string">&#x27;v&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过回车键来代替单击操作</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).send_keys(Keys.ENTER)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>需要说明的是， 上面的脚本没有什么实际意义， 仅向我们展示模拟键盘各种按键与组合键的用法。</p><p>from selenium.webdriver.common.keys import Keys<br>在使用键盘按键方法前需要先导入 keys 类。</p><p>以下为常用的键盘操作：</p><table><thead><tr><th>send_keys(Keys.BACK_SPACE)</th><th>删除键（BackSpace）</th></tr></thead><tbody><tr><td>send_keys(Keys.SPACE)</td><td>空格键(Space)</td></tr><tr><td>send_keys(Keys.TAB)</td><td>制表键(Tab)</td></tr><tr><td>send_keys(Keys.ESCAPE)</td><td>回退键（Esc）</td></tr><tr><td>send_keys(Keys.ENTER)</td><td>回车键（Enter）</td></tr><tr><td>send_keys(Keys.CONTROL,’a’)</td><td>全选（Ctrl+A）</td></tr><tr><td>send_keys(Keys.CONTROL,’c’)</td><td>复制（Ctrl+C）</td></tr><tr><td>send_keys(Keys.CONTROL,’x’)</td><td>剪切（Ctrl+X）</td></tr><tr><td>send_keys(Keys.CONTROL,’v’)</td><td>粘贴（Ctrl+V）</td></tr><tr><td>send_keys(Keys.F1)</td><td>键盘 F1</td></tr><tr><td>send_keys(Keys.F12)</td><td>键盘 F12</td></tr></tbody></table><h2 id="3-事件处理"><a href="#3-事件处理" class="headerlink" title="3. 事件处理"></a>3. 事件处理</h2><h3 id="3-1-断言判断"><a href="#3-1-断言判断" class="headerlink" title="3.1 断言判断"></a>3.1 断言判断</h3><p>不管是在做功能测试还是自动化测试，最后一步需要拿实际结果与预期进行比较。这个比较的称之为断言。</p><p>我们通常可以通过获取title 、URL和text等信息进行断言。text方法在前面已经讲过，它用于获取标签对之间的文本信息。 下面同样以百度为例，介绍如何获取这些信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;Before search================&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印当前页面title</span></span><br><span class="line">title = driver.title</span><br><span class="line">print(title)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印当前页面URL</span></span><br><span class="line">now_url = driver.current_url</span><br><span class="line">print(now_url)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;selenium&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;After search================&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次打印当前页面title</span></span><br><span class="line">title = driver.title</span><br><span class="line">print(title)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印当前页面URL</span></span><br><span class="line">now_url = driver.current_url</span><br><span class="line">print(now_url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取结果数目</span></span><br><span class="line">user = driver.find_element_by_class_name(<span class="string">&#x27;nums&#x27;</span>).text</span><br><span class="line">print(user)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>脚本运行结果如下：</p><p>Before search================<br>百度一下，你就知道<br><a href="https://www.baidu.com/">https://www.baidu.com/</a><br>After search================<br>selenium_百度搜索<br><a href="https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=0&amp;rsv_idx">https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=0&amp;rsv_idx</a>…<br>搜索工具<br>百度为您找到相关结果约61,100,000个<br>title：用于获得当前页面的标题。</p><p>current_url：用户获得当前页面的URL。</p><p>text：获取搜索条目的文本信息。</p><h3 id="3-2-元素等待"><a href="#3-2-元素等待" class="headerlink" title="3.2 元素等待"></a>3.2 元素等待</h3><p>WebDriver提供了两种类型的等待：显式等待和隐式等待。</p><p>显式等待<br>显式等待使WebdDriver等待某个条件成立时继续执行，否则在达到最大时长时抛出超时异常（TimeoutException）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">element = WebDriverWait(driver, <span class="number">5</span>, <span class="number">0.5</span>).until(</span><br><span class="line">                      EC.presence_of_element_located((By.ID, <span class="string">&quot;kw&quot;</span>))</span><br><span class="line">                      )</span><br><span class="line">element.send_keys(<span class="string">&#x27;selenium&#x27;</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>WebDriverWait类是由WebDirver 提供的等待方法。在设置时间内，默认每隔一段时间检测一次当前页面元素是否存在，如果超过设置时间检测不到则抛出异常。具体格式如下：</p><p>WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)<br>driver ：浏览器驱动。</p><p>timeout ：最长超时时间，默认以秒为单位。</p><p>poll_frequency ：检测的间隔（步长）时间，默认为0.5S。</p><p>ignored_exceptions ：超时后的异常信息，默认情况下抛NoSuchElementException异常。</p><p>WebDriverWait()一般由until()或until_not()方法配合使用，下面是until()和until_not()方法的说明。</p><p>until(method, message=‘’)<br>调用该方法提供的驱动程序作为一个参数，直到返回值为True。</p><p>until_not(method, message=‘’)<br>调用该方法提供的驱动程序作为一个参数，直到返回值为False。</p><p>在本例中，通过as关键字将expected_conditions 重命名为EC，并调用presence_of_element_located()方法判断元素是否存在。</p><p>隐式等待<br>WebDriver提供了implicitly_wait()方法来实现隐式等待，默认设置为0。它的用法相对来说要简单得多。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置隐式等待为10秒</span></span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    print(ctime())</span><br><span class="line">    driver.find_element_by_id(<span class="string">&quot;kw22&quot;</span>).send_keys(<span class="string">&#x27;selenium&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> NoSuchElementException <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    print(ctime())</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure><p>implicitly_wait() 默认参数的单位为秒，本例中设置等待时长为10秒。首先这10秒并非一个固定的等待时间，它并不影响脚本的执行速度。其次，它并不针对页面上的某一元素进行等待。当脚本执行到某个元素定位时，如果元素可以定位，则继续执行；如果元素定位不到，则它将以轮询的方式不断地判断元素是否被定位到。假设在第6秒定位到了元素则继续执行，若直到超出设置时长（10秒）还没有定位到元素，则抛出异常。</p><h3 id="3-3-元素定位"><a href="#3-3-元素定位" class="headerlink" title="3.3 元素定位"></a>3.3 元素定位</h3><p>WebDriver还提供了8种用于定位一组元素的方法。</p><p>find_elements_by_id()<br>find_elements_by_name()<br>find_elements_by_class_name()<br>find_elements_by_tag_name()<br>find_elements_by_link_text()<br>find_elements_by_partial_link_text()<br>find_elements_by_xpath()<br>find_elements_by_css_selector()<br>定位一组元素的方法与定位单个元素的方法类似，唯一的区别是在单词element后面多了一个s表示复数。</p><p>接下来通过例子演示定位一组元素的使用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;selenium&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定位一组元素</span></span><br><span class="line">texts = driver.find_elements_by_xpath(<span class="string">&#x27;//div/h3/a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环遍历出每一条搜索结果的标题</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> texts:</span><br><span class="line">    print(t.text)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>程序运行结果：</p><p>Selenium - Web Browser Automation<br>官网<br>功能自动化测试工具——Selenium篇<br>selenium + python自动化测试环境搭建 - 虫师 - 博客园<br>selenium是什么?_百度知道<br>怎样开始用selenium进行自动化测试(个人总结)_百度经验<br>Selenium_百度百科<br>selenium_百度翻译<br>Selenium官网教程_selenium自动化测试实践_Selenium_领测软件测试网<br>Selenium(浏览器自动化测试框架)_百度百科<br>自动化基础普及之selenium是啥? - 虫师 - 博客园<br>python十大主流开源框架 「菜鸟必看」</p><h3 id="3-4-多表单切换"><a href="#3-4-多表单切换" class="headerlink" title="3.4 多表单切换"></a>3.4 多表单切换</h3><p>在Web应用中经常会遇到frame/iframe表单嵌套页面的应用，WebDriver只能在一个页面上对元素识别与定位，对于frame/iframe表单内嵌页面上的元素无法直接定位。这时就需要通过switch_to.frame()方法将当前定位的主体切换为frame/iframe表单的内嵌页面中。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;x-URS-iframe&quot;</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">           ...</span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure><p>126邮箱登录框的结构大概是这样子的，想要操作登录框必须要先切换到iframe表单。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.126.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.switch_to.frame(<span class="string">&#x27;x-URS-iframe&#x27;</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;email&quot;</span>).clear()</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;email&quot;</span>).send_keys(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).clear()</span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;password&quot;</span>).send_keys(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;dologin&quot;</span>).click()</span><br><span class="line">driver.switch_to.default_content()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br><span class="line">switch_to.frame() 默认可以直接取表单的<span class="built_in">id</span> 或name属性。如果iframe没有可用的<span class="built_in">id</span>和name属性，则可以通过下面的方式进行定位。</span><br></pre></td></tr></table></figure><p>……<br>#先通过xpth定位到iframe</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xf = driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;x-URS-iframe&quot;]&#x27;</span>)</span><br></pre></td></tr></table></figure><p>#再将定位对象传给switch_to.frame()方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(xf)</span><br></pre></td></tr></table></figure><p>……</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.parent_frame()</span><br></pre></td></tr></table></figure><p>除此之外，在进入多级表单的情况下，还可以通过switch_to.default_content()跳回最外层的页面。</p><h3 id="3-5-多窗口切换"><a href="#3-5-多窗口切换" class="headerlink" title="3.5 多窗口切换"></a>3.5 多窗口切换</h3><p>在页面操作过程中有时候点击某个链接会弹出新的窗口，这时就需要主机切换到新打开的窗口上进行操作。WebDriver提供了switch_to.window()方法，可以实现在不同的窗口之间切换。 以百度首页和百度注册页为例，在两个窗口之间的切换如下图。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得百度搜索窗口句柄</span></span><br><span class="line">sreach_windows = driver.current_window_handle</span><br><span class="line"></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;登录&#x27;</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;立即注册&quot;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得当前所有打开的窗口的句柄</span></span><br><span class="line">all_handles = driver.window_handles</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入注册窗口</span></span><br><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> all_handles:</span><br><span class="line">    <span class="keyword">if</span> handle != sreach_windows:</span><br><span class="line">        driver.switch_to.window(handle)</span><br><span class="line">        print(<span class="string">&#x27;now register window!&#x27;</span>)</span><br><span class="line">        driver.find_element_by_name(<span class="string">&quot;account&quot;</span>).send_keys(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).send_keys(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># ……</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>在本例中所涉及的新方法如下：</p><ul><li>current_window_handle：获得当前窗口句柄。</li><li>window_handles：返回所有窗口的句柄到当前会话。</li><li>switch_to.window()：用于切换到相应的窗口，与上一节的switch_to.frame()类似，前者用于不同窗口的切换，后者用于不同表单之间的切换。</li></ul><h3 id="3-6-警告框处理"><a href="#3-6-警告框处理" class="headerlink" title="3.6 警告框处理"></a>3.6 警告框处理</h3><p>在WebDriver中处理JavaScript所生成的alert、confirm以及prompt十分简单，具体做法是使用 switch_to.alert 方法定位到 alert/confirm/prompt，然后使用text/accept/dismiss/ send_keys等方法进行操作。</p><ul><li>text：返回 alert/confirm/prompt 中的文字信息。</li><li>accept()：接受现有警告框。</li><li>dismiss()：解散现有警告框。</li><li>send_keys(keysToSend)：发送文本至警告框。keysToSend：将文本发送至警告框。</li></ul><p>如下图，百度搜索设置弹出的窗口是不能通过前端工具对其进行定位的，这个时候就可以通过switch_to_alert()方法接受这个弹窗。 <img src="http://orru5lls3.bkt.clouddn.com/alert_windows.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 鼠标悬停至“设置”链接</span></span><br><span class="line">link = driver.find_element_by_link_text(<span class="string">&#x27;设置&#x27;</span>)</span><br><span class="line">ActionChains(driver).move_to_element(link).perform()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开搜索设置</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;搜索设置&quot;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存设置</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;prefpanelgo&quot;</span>).click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接受警告框</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>通过switch_to_alert()方法获取当前页面上的警告框，并使用accept()方法接受警告框。</p><h3 id="3-7-警告框处理"><a href="#3-7-警告框处理" class="headerlink" title="3.7 警告框处理"></a>3.7 警告框处理</h3><p>在WebDriver中处理JavaScript所生成的alert、confirm以及prompt十分简单，具体做法是使用 switch_to.alert 方法定位到 alert/confirm/prompt，然后使用text/accept/dismiss/ send_keys等方法进行操作。</p><ul><li>text：返回 alert/confirm/prompt 中的文字信息。</li><li>accept()：接受现有警告框。</li><li>dismiss()：解散现有警告框。</li><li>send_keys(keysToSend)：发送文本至警告框。keysToSend：将文本发送至警告框。</li></ul><p>如下图，百度搜索设置弹出的窗口是不能通过前端工具对其进行定位的，这个时候就可以通过switch_to_alert()方法接受这个弹窗。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 鼠标悬停至“设置”链接</span></span><br><span class="line">link = driver.find_element_by_link_text(<span class="string">&#x27;设置&#x27;</span>)</span><br><span class="line">ActionChains(driver).move_to_element(link).perform()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开搜索设置</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;搜索设置&quot;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存设置</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;prefpanelgo&quot;</span>).click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接受警告框</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>通过switch_to_alert()方法获取当前页面上的警告框，并使用accept()方法接受警告框。</p><h3 id="3-8-下拉框选择"><a href="#3-8-下拉框选择" class="headerlink" title="3.8 下拉框选择"></a>3.8 下拉框选择</h3><p>有时我们会碰到下拉框，WebDriver提供了Select类来处理下拉框。 如百度搜索设置的下拉框。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 鼠标悬停至“设置”链接</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;设置&#x27;</span>).click()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 打开搜索设置</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&quot;搜索设置&quot;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索结果显示条数</span></span><br><span class="line">sel = driver.find_element_by_xpath(<span class="string">&quot;//select[@id=&#x27;nr&#x27;]&quot;</span>)</span><br><span class="line">Select(sel).select_by_value(<span class="string">&#x27;50&#x27;</span>)  <span class="comment"># 显示50条</span></span><br><span class="line"><span class="comment"># ……</span></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>Select类用于定位select标签。</p><p>select_by_value() 方法用于定位下接选项中的value值。</p><h2 id="4-特殊处理"><a href="#4-特殊处理" class="headerlink" title="4. 特殊处理"></a>4. 特殊处理</h2><h3 id="4-1-文件上传"><a href="#4-1-文件上传" class="headerlink" title="4.1 文件上传"></a>4.1 文件上传</h3><p>对于通过input标签实现的上传功能，可以将其看作是一个输入框，即通过send_keys()指定本地文件路径的方式实现文件上传。</p><p>创建upfile.html文件，代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>upload_file<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row-fluid&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;span6 well&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>upload_file<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.js&quot;</span>&gt;</span><span class="handlebars"><span class="xml"><span class="tag">&lt;/<span class="name">scrip</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure><p>通过浏览器打开upfile.html文件.</p><p>接下来通过send_keys()方法来实现文件上传。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">file_path = <span class="string">&#x27;file:///&#x27;</span> + os.path.abspath(<span class="string">&#x27;upfile.html&#x27;</span>)</span><br><span class="line">driver.get(file_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定位上传按钮，添加本地文件</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&quot;file&quot;</span>).send_keys(<span class="string">&#x27;D:\\upload_file.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><h3 id="4-2-cookies处理"><a href="#4-2-cookies处理" class="headerlink" title="4.2 cookies处理"></a>4.2 cookies处理</h3><p>有时候我们需要验证浏览器中cookie是否正确，因为基于真实cookie的测试是无法通过白盒和集成测试进行的。WebDriver提供了操作Cookie的相关方法，可以读取、添加和删除cookie信息。</p><p>WebDriver操作cookie的方法：</p><ul><li>get_cookies()： 获得所有cookie信息。</li><li>get_cookie(name)： 返回字典的key为“name”的cookie信息。</li><li>add_cookie(cookie_dict) ： 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值。</li><li>delete_cookie(name,optionsString)：删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项，目前支持的选项包括“路径”，“域”。</li><li>delete_all_cookies()： 删除所有cookie信息。</li></ul><p>下面通过get_cookies()来获取当前浏览器的cookie信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.youdao.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得cookie信息</span></span><br><span class="line">cookie= driver.get_cookies()</span><br><span class="line"><span class="comment"># 将获得cookie的信息打印</span></span><br><span class="line">print(cookie)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>从执行结果可以看出，cookie数据是以字典的形式进行存放的。知道了cookie的存放形式，接下来我们就可以按照这种形式向浏览器中写入cookie信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.youdao.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 向cookie的name 和value中添加会话信息</span></span><br><span class="line">driver.add_cookie(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;key-aaaaaaa&#x27;</span>, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;value-bbbbbb&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历cookies中的name 和value信息并打印，当然还有上面添加的信息</span></span><br><span class="line"><span class="keyword">for</span> cookie <span class="keyword">in</span> driver.get_cookies():</span><br><span class="line">    print(<span class="string">&quot;%s -&gt; %s&quot;</span> % (cookie[<span class="string">&#x27;name&#x27;</span>], cookie[<span class="string">&#x27;value&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>输出结果：</p><p>======================== RESTART: =========================</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">YOUDAO_MOBILE_ACCESS_TYPE -&gt; 1</span><br><span class="line">_PREF_ANONYUSER__MYTH -&gt; aGFzbG9nZ2VkPXRydWU&#x3D;</span><br><span class="line">OUTFOX_SEARCH_USER_ID -&gt; -1046383847@218.17.158.115</span><br><span class="line">JSESSIONID -&gt; abc7qSE_SBGsVgnVLBvcu</span><br><span class="line">key-aaaaaaa -&gt; value-bbbbbb</span><br></pre></td></tr></table></figure><p>从执行结果可以看到，最后一条cookie信息是在脚本执行过程中通过add_cookie()方法添加的。通过遍历得到所有的cookie信息，从而找到key为“name”和“value”的特定cookie的value。</p><h3 id="4-3-js处理"><a href="#4-3-js处理" class="headerlink" title="4.3 js处理"></a>4.3 js处理</h3><p>虽然WebDriver提供了操作浏览器的前进和后退方法，但对于浏览器滚动条并没有提供相应的操作方法。在这种情况下，就可以借助JavaScript来控制浏览器的滚动条。WebDriver提供了execute_script()方法来执行JavaScript代码。</p><p>用于调整浏览器滚动条位置的JavaScript代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- window.scrollTo(左边距,上边距); --&gt;</span><br><span class="line">window.scrollTo(0,450);</span><br></pre></td></tr></table></figure><p>window.scrollTo()方法用于设置浏览器窗口滚动条的水平和垂直位置。方法的第一个参数表示水平的左间距，第二个参数表示垂直的上边距。其代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问百度</span></span><br><span class="line">driver=webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器窗口大小</span></span><br><span class="line">driver.set_window_size(<span class="number">500</span>, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;selenium&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过javascript设置浏览器窗口的滚动条位置</span></span><br><span class="line">js=<span class="string">&quot;window.scrollTo(100,450);&quot;</span></span><br><span class="line">driver.execute_script(js)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>通过浏览器打开百度进行搜索，并且提前通过set_window_size()方法将浏览器窗口设置为固定宽高显示，目的是让窗口出现水平和垂直滚动条。然后通过execute_script()方法执行JavaScripts代码来移动滚动条的位置。</p><h3 id="4-4-窗口截图"><a href="#4-4-窗口截图" class="headerlink" title="4.4 窗口截图"></a>4.4 窗口截图</h3><p>自动化用例是由程序去执行的，因此有时候打印的错误信息并不十分明确。如果在脚本执行出错的时候能对当前窗口截图保存，那么通过图片就可以非常直观地看出出错的原因。WebDriver提供了截图函数get_screenshot_as_file()来截取当前窗口。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>).send_keys(<span class="string">&#x27;selenium&#x27;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;su&#x27;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截取当前窗口，并指定截图图片的保存位置</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">&quot;E:\\baidu_img.jpg&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>脚本运行完成后打开E盘，就可以找到baidu_img.jpg图片文件了。</p><h3 id="4-5-窗口关闭"><a href="#4-5-窗口关闭" class="headerlink" title="4.5 窗口关闭"></a>4.5 窗口关闭</h3><p>在前面的例子中我们一直使用quit()方法，其含义为退出相关的驱动程序和关闭所有窗口。除此之外，WebDriver还提供了close()方法，用来关闭当前窗口。例多窗口的处理，在用例执行的过程中打开了多个窗口，我们想要关闭其中的某个窗口，这时就要用到close()方法进行关闭了。</p><ul><li>close() 关闭单个窗口</li><li>quit() 关闭所有窗口</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cover:</span></span><br><span class="line">  <span class="comment"># 是否显示文章封面</span></span><br><span class="line">  <span class="attr">index_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">aside_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 封面显示的位置</span></span><br><span class="line">  <span class="comment"># 三个值可配置 left , right , both</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">both</span></span><br><span class="line">  <span class="comment"># 当没有设置cover时，默认的封面显示</span></span><br><span class="line">  <span class="attr">default_cover:</span> <span class="string">https://s1.ax1x.com/2020/10/28/Bl2uBF.jpg</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">作者:</span> <span class="string">Jerry</span></span><br><span class="line"><span class="string">連結:</span> <span class="string">https://demo.jerryc.me/posts/4aa8abbe/#%E6%96%87%E7%AB%A0%E7%BD%AE%E9%A0%82</span></span><br><span class="line"><span class="string">來源:</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="string">著作權歸作者所有。商業轉載請聯絡作者獲得授權，非商業轉載請註明出處。</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Selenium3实现网页自动化&quot;&gt;&lt;a href=&quot;#Selenium3实现网页自动化&quot; class=&quot;headerlink&quot; title=&quot;Selenium3实现网页自动化&quot;&gt;&lt;/a&gt;Selenium3实现网页自动化&lt;/h1&gt;&lt;h2 id=&quot;1-初步工作&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="笔记" scheme="http://example.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="python" scheme="http://example.com/categories/%E7%AC%94%E8%AE%B0/python/"/>
    
    
    <category term="Selenium" scheme="http://example.com/tags/Selenium/"/>
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="自动化" scheme="http://example.com/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2020/10/27/hello-world/"/>
    <id>http://example.com/2020/10/27/hello-world/</id>
    <published>2020-10-27T08:10:26.128Z</published>
    <updated>2020-10-27T08:10:26.128Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
